<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Ncer Faculties</title>

    <!--  Bootstrap CSS  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Style CSS -->

    <link rel="stylesheet" href="/static/css/inner faculties.css" />

    <!----======== Javascript ======== -->

    <script>
        src =
            "//cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js";
    </script>
    <link rel="stylesheet" href="/static/javascript/script.js" />

    <!----======== Jquery slim ======== -->

    <script src="https://code.jquery.com/jquery-3.7.1.slim.js"
        integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>

    <!----===== Boxicons CSS ===== -->
    <link href="https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css" rel="stylesheet" />

    <!-- fork Awesome -->
    <script src="https://kit.fontawesome.com/d8acde37bb.js" crossorigin="anonymous"></script>

    <!-- excel library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
</head>

<body>

    <!--background wallpaper wrapper-->

    <div style="
        background: url(/static/images/pexels-eberhard-grossgasteiger-844297.jpg);


        
      " class="page-holder bg-cover">
        <div class="navbar">
            <h1 class="logo text-white">Faculty Portal</h1>

            <nav>
                <ul>
                    <li>
                        <button type="button" class="btn btn-primary navhome" onclick="showHome()">
                            Home
                        </button>
                    </li>

                    <li>
                        <button type="button" class="btn btn-primary navreg" onclick="showHome()">
                            Logout
                        </button>
                    </li>
                </ul>
            </nav>
        </div>





        <!-- SECTION 1 header -->
        <h1 class="heading text-dark mt-5 mb-4 text-center">
            <i class="fas fa-chalkboard-teacher"></i> <!-- Font Awesome icon for faculty -->
            Faculty and TPO Dashboard
        </h1>

        <!-- Student data  card 1 -->
        <div class="bigcard">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">Retrieve Student Information</h5>
                                <p class="card-text">
                                    Access comprehensive student data with a single click.
                                </p>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#departmentModal">
                                    Access Student Information
                                </button>
                            </div>
                        </div>
                    </div>


                    <!------  Resource Sharing card 2 -->
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">Resource Sharing</h5>
                                <p class="card-text">
                                    Share supplementary learning resources with students.
                                </p>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#resourceSharingModal">
                                    Share Resources
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- view Student data  card 3 -->
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">View Registered Students</h5>
                                <p class="card-text">
                                    View data of registered students.
                                </p>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#viewStudentDataModal" onclick="displayExcelContent()">
                                    View Students Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!--   card 4 -->
                    <div class="col-md-6">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">Add Drive Information</h5>
                                <p class="card-text">
                                    Use the button below to send Information to all students.
                                </p>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#driveInformationModal">
                                    Add Drive Information
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- Student data Modal  card 1 -->
    <div class="modal fade" id="departmentModal" tabindex="-1" aria-labelledby="departmentModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form action="/download_stu_data" method="post">
                    <div class="modal-header">
                        <h5 class="modal-title" id="departmentModalLabel">
                            Select Department
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <!-- Dropdown for selecting department -->
                        <div class="mb-3">
                            <label for="department" class="form-label">Department</label>
                            <select class="form-select mb-3 department-dropdown" aria-label="Select Department"
                                name="dept">
                                <option>Select a Department</option>
                                <option>Computer Science Engineering</option>
                                <option>Electronics & Telecommunication Engineering</option>
                                <option>Mechanical Engineering</option>
                                <option>Artificial Intelligence</option>
                                <option>Civil Engineering</option>
                                <!-- Add more departments as needed -->
                            </select>
                        </div>

                        <!-- Year selection -->
                        <div class="mb-3">
                            <label for="year" class="form-label">Year</label>
                            <select class="form-select mb-3 year-dropdown" aria-label="Select Year" name="year">
                                <option>Select a Year</option>
                                <option>First Year</option>
                                <option>Second Year</option>
                                <option>Third Year</option>
                                <option>Fourth Year</option>
                                <!-- Add more years as needed -->
                            </select>
                        </div>

                        <!-- Button to get student data -->
                        <button type="submit" class="btn btn-primary" onclick="getStudentData()">
                            Get Student Data
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>



    <!-- Resource Sharing Modal card - 2 -->
    <div class="modal fade" id="resourceSharingModal" tabindex="-1" aria-labelledby="resourceSharingModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="resourceSharingModalLabel">Share Resources</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <textarea class="form-control" id="message" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="file" class="form-label">Upload File</label>
                            <input class="form-control" type="file" id="file" />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="shareResources()">Send</button>
                </div>
            </div>
        </div>
    </div>




    <!-- View Student Data Modal  card-3   -------->
    <div class="modal fade" id="viewStudentDataModal" tabindex="-1" aria-labelledby="viewStudentDataModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg"> <!-- Use modal-lg class for large modal -->
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewStudentDataModalLabel">Registered Students Data</h5>
                    <button type="submit" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Large card within the modal -->
                    <div class="card shadow-lg"> <!-- Add shadow-lg class for shadow effect -->
                        <div class="card-body">
                            <div id="excel-table"></div>
                            <!-- Student data table or any other content here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Drive Information Modal card - 4    -------->
    <div class="modal fade" id="driveInformationModal" tabindex="-1" aria-labelledby="driveInformationModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="driveInformationModalLabel">
                        Add Drive Information
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form action="/send_message" method="post" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="companyName" class="form-label">Company Name</label>
                            <input type="text" class="form-control" id="companyName" name="c_name" />
                        </div>
                        <div class="mb-3">
                            <label for="driveDate" class="form-label">Drive Date</label>
                            <input type="date" class="form-control" id="driveDate" name="d_date" />
                        </div>
                        <div class="mb-3">
                            <label for="driveTime" class="form-label">Drive Time</label>
                            <input type="time" class="form-control" id="driveTime" name="d_time" />
                        </div> 
                        <div class="mb-3">
                            <label for="jobRole" class="form-label">Job Role</label>
                            <input type="text" class="form-control" id="jobRole" name="j_role" />
                        </div>
                        <!-- Dropdown for selecting department -->
                        <div class="mb-3">
                            <label for="department" class="form-label">Department</label>
                            <select class="form-select mb-3 department-dropdown" aria-label="Select Department"
                                name="dept">
                                <option>Select a Department</option>
                                <option>All Departments</option>
                                <option>Computer Science Engineering</option>
                                <option>Electronics & Telecommunication Engineering</option>
                                <option>Mechanical Engineering</option>
                                <option>Artificial Intelligence</option>
                                <option>Civil Engineering</option>
                                <!-- Add more departments as needed -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <textarea class="form-control" id="message" rows="3" name="message"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="file" class="form-label">Select File</label>
                            <input class="form-control" type="file" id="file" name="campus_file" />
                        </div>
                        <button type="submit" class="btn btn-warning w-100" onclick="sendDriveInformation()">
                            Send
                        </button>
                    </form>
                </div>

            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmationModalLabel">
                        Are you sure?
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="button" class="btn btn-primary">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- footer --->

    <footer id="sticky-footer" class="flex-shrink-0 py-4 bg-dark text-white-50">
        <div class="container text-center">
            <small>Copyright &copy; Team Dharma Warriors </small>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- jQuery Slim -->
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
        integrity="sha256-UgvvN8vBkgO0luPSUl2s8TIlOSYRoGFAX4jlCIm9Adc=" crossorigin="anonymous"></script>
</body>

<script>
    function register() {
        window.location.href = "/register.html";
    }

    function showHome() {
        window.location.href = "/index.html";
    }

    function Logout() {
        window.location.href = "/sign_in.html";
    }
</script>

<script>
    async function displayExcelContent() {
        try {
            const response = await fetch("static/student_data_show.xlsx");
            const arrayBuffer = await response.arrayBuffer();
            // Use SheetJS to read Excel data
            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            // Convert sheet data to HTML table
            const tableHTML = XLSX.utils.sheet_to_html(sheet);
            // Display table
            document.getElementById('excel-table').innerHTML = tableHTML;
            console.log(sheet);
        } catch (error) {
            console.error('Error fetching and displaying Excel data:', error);
        }
    }
    // Call the function when the page loads
    displayExcelContent();
</script>

</html>